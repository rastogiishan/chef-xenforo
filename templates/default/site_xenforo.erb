NameVirtualHost 0.0.0.0:<% if node['xenforo']['enable_ssl'] %>443<% else %>80<% end %>
<VirtualHost 0.0.0.0:<% if node['xenforo']['enable_ssl'] %>443<% else %>80<% end %>>
     ServerName <%= node['xenforo']['server_name'] %>
     ServerAlias <%= node['xenforo']['server_aliases'] %>
     DocumentRoot <%= node['xenforo']['htdocs_xenforo'] %>
     PHPINIDir <%= @phpinidir %>
     <% if node['xenforo']['enable_ssl'] %>
     SSLEngine On
     SSLCertificateFile <%= node['xenforo']['ssl_public'] %>
     SSLCertificateKeyFile <%= node['xenforo']['ssl_private'] %>
     SSLCACertificateFile <%= node['xenforo']['ca_cert'] %>
     SSLHonorCipherOrder on
     SSLProtocol <%= node['xenforo']['sslprotocol'] %>
     SSLCipherSuite <%= node['xenforo']['sslciphersuite'] %>
     SSLCompression off
     ServerSignature off
     <% end %>
     <Directory <%= node['xenforo']['htdocs_xenforo'] %>>
       AllowOverride All
       Options -Indexes +FollowSymLinks
     <% if node['xenforo']['enable_htpasswd'] %>
       AuthType Basic
       AuthName <%= node['xenforo']['name'] %>
       Require valid-user
       AuthUserFile <%= node['xenforo']['htpasswd_file'] %>
     <% end %>
     </Directory>
     <% if node['xenforo']['install_allow_from'] != '' %>
     <Location /install>
       Order Deny,Allow
       Deny from all
       Allow from <%= node['xenforo']['install_allow_from'] %>
     </Location>
     <% end %>
     CustomLog <%= node['xenforo']['customlog'] %>
     ErrorLog <%= node['xenforo']['errorlog'] %>
</VirtualHost>
